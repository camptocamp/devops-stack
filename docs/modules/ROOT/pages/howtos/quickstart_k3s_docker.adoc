= K3s on Docker Quickstart

== Prerequisites

- Access to a functional Docker Engine,
- CGroupv2 disabled (K3s does not support it for now),
- Knowledge of https://terraform.io[Terraform] basics

== Create the Terraform root module

```hcl
module "cluster" {
  source = "git::https://github.com/camptocamp/camptocamp-devops-stack.git//modules/k3s/docker?ref=master"

  cluster_name = "my-cluster"
}
```


include::partial$pipeline_outputs.adoc[]


== Deploy the cluster

```shell
$ terraform init
$ terraform apply
```

You should see the services URL as Terraform outputs.

== Get kubeconfig and admin password

Retrieve the Kubeconfig file:

```shell
$ terraform output -json kubeconfig | jq -r .
```


Retrieve the Keycloak admin password:

```shell
$ terraform output admin_password
```


== Inspect the DevOps Stack Applications


You can view the various ingress routes with:

```
$ kubectl get ingress --all-namespaces
```

Access the URLs in https, and use the OIDC/OAuth2 to log in, using the `admin`
account with the password previously retrieved.


== Destroy the cluster

```shell
$ terraform destroy
```
